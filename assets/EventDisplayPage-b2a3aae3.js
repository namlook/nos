import{d as k,r as n,J as E,q as w,o as r,v as p,b as y,t as x,H as D,I as O,E as B,_ as b,N as I,O as P}from"./index-92a64d0e.js";import{d as g,N as j,n as A,i as C,e as S,f as L,u as T}from"./NsEvent-b591ab94.js";const U={key:2},q=k({__name:"NsThread",props:{event:{type:Object},relays:{type:Array,default:()=>[]},id:{type:String},root:{type:Object},inline:Boolean,inThread:Boolean},setup(t){const l=t,{fetch:m,findOne:o}=T(),e=n(l.event),s=n([]),i=n([]),f=n([]),c=n(!1);return E(async()=>{var d;if(l.id&&(c.value=!0,e.value=await o(l.id),c.value=!1),!e.value)throw c.value=!1,new Error("event not found");const h=((d=e.value)==null?void 0:d.schema.sameAs)??A.noteEncode(e.value.id),u=await m([{kinds:[1,7],"#e":[e.value.id],limit:1e3}],{batchId:"events"});s.value=u.filter(C).filter(a=>{var v,_,N;return((v=a.schema.parentItem)==null?void 0:v["@id"])===h||!((_=a.schema.parentItem)!=null&&_["@id"])&&((N=a.schema.mainEntity)==null?void 0:N["@id"])===h}).sort((a,v)=>a.created_at-v.created_at),i.value=u.filter(S),f.value=u.filter(L),c.value=!1}),(h,u)=>{const d=w("NsThread",!0);return c.value?(r(),p(g,{key:0,"in-thread":t.inThread},null,8,["in-thread"])):e.value?(r(),y("div",{key:1,class:B(["ns-thread-component",{"white-box":!t.inThread}])},[x(j,{event:e.value,"in-thread":!!t.root,comments:s.value,reactions:i.value,reposts:f.value},null,8,["event","in-thread","comments","reactions","reposts"]),(r(!0),y(D,null,O(s.value,a=>(r(),p(d,{class:"ml-2 border-left-2 border-primary-100",key:a.id,event:a,root:t.root??e.value,"in-thread":""},null,8,["event","root"]))),128))],2)):(r(),y("div",U,"NOT FOUND"))}}});const F=b(q,[["__scopeId","data-v-5be3ffdd"],["__file","/Users/nicolasc/Documents/projects/others/nosworld/src/components/structures/NsThread/NsThread.vue"]]),R=k({__name:"EventDisplayPage",props:{id:{type:String,required:!0}},setup(t){const l=t,m=I(),o=n(),{findOne:e}=T(),s=n(!1);return E(async()=>{var i;if(s.value=!0,o.value=await e(l.id),((i=o.value)==null?void 0:i.schema["@type"])==="Person"){m.push({name:P.profile.display,params:{pubkey:o.value.pubkey},replace:!0});return}s.value=!1}),(i,f)=>s.value?(r(),p(g,{key:0})):(r(),p(F,{key:1,id:t.id,event:o.value},null,8,["id","event"]))}}),J=b(R,[["__file","/Users/nicolasc/Documents/projects/others/nosworld/src/pages/EventDisplayPage/EventDisplayPage.vue"]]);export{J as default};
