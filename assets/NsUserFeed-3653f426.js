import{r as f,af as U,ag as b,h as F,S as A,d as $,q as k,o as v,c as _,b as n,e as h,f as p,s as S,F as w,g as N,H as R,_ as q}from"./index-2a1b294f.js";import{a as B,N as D}from"./NsEvent-2f64f645.js";import{s as y}from"./inputswitch.esm-94cf1065.js";const{loadUsersActivities:L,fetchUserFollowers:C}=F(),E=(i,{withReplies:r,withReactions:d,withReposts:a,withZaps:o})=>{const c=A();let s=["Article","SocialMediaPosting","Thing"];r&&(s=[...s,"Comment"]);let l=[{"schema.author.@id":{$in:i},"schema.@type":{$in:s}}],t=[];return d&&(t=[...t,"LikeAction","DislikeAction","ReactAction"]),a&&(t=[...t,"ShareAction"]),t.length&&(l=[...l,{"schema.agent.@id":{$in:i},"schema.@type":{$in:t}}]),o&&(l=[...l,{"schema.customer.@id":{$in:i},"schema.@type":"Invoice"}]),c.events.find({selector:{$or:l},sort:[{created_at:"desc"}],limit:100}).exec()};function I(i,r,{showReplies:d,showReactions:a,showReposts:o,showZaps:c}){const s=f(!1),l=f([]),t=async x=>{s.value=!0;const g=b(x);let m=[];r.value==="activity"?m=[g]:r.value==="feed"&&(m=await C(g)),await L(m,{withReplies:d.value,withReactions:a.value,withReposts:o.value,withZaps:c.value}),l.value=await E(m,{withReplies:d.value,withReactions:a.value,withReposts:o.value,withZaps:c.value}),s.value=!1};return U(async()=>{console.log("updating user feed",a.value,d.value,o.value),t(i.value)}),{isLoading:s,feed:l,refetch:async()=>{t(i.value)}}}const j={class:"ns-user-feed-component"},H={class:"flex justify-content-between mb-4 inset-shadow-1 p-3 border-round"},T={class:"flex align-items-center gap-2"},Z=n("i",{class:"pi pi-sync"},null,-1),M={class:"flex align-items-center gap-2"},P=n("i",{class:"pi pi-comments"},null,-1),z={class:"flex align-items-center gap-2"},G=n("i",{class:"pi pi-thumbs-up"},null,-1),J={class:"flex align-items-center gap-2"},K=n("i",{class:"pi pi-bolt"},null,-1),O={key:0,class:"flex flex-column gap-4"},Q={key:1,class:"flex flex-column gap-4"},W=$({__name:"NsUserFeed",props:{type:{type:String,required:!0},pubkey:{type:String,required:!0}},setup(i){const r=i,d=f(!1),a=f(!1),o=f(!1),c=f(!0),s=f(!1),l=k(()=>r.pubkey),t=k(()=>r.type),{isLoading:V,feed:x,refetch:g}=I(l,t,{showReplies:a,showReactions:o,showReposts:c,showZaps:s}),m=()=>{g()};return(X,u)=>(v(),_("div",j,[n("div",H,[h(p(S),{class:"p-1",loading:d.value,outlined:"",icon:"pi pi-refresh",onClick:m},null,8,["loading"]),n("div",T,[h(p(y),{modelValue:c.value,"onUpdate:modelValue":u[0]||(u[0]=e=>c.value=e)},null,8,["modelValue"]),Z]),n("div",M,[h(p(y),{modelValue:a.value,"onUpdate:modelValue":u[1]||(u[1]=e=>a.value=e)},null,8,["modelValue"]),P]),n("div",z,[h(p(y),{modelValue:o.value,"onUpdate:modelValue":u[2]||(u[2]=e=>o.value=e)},null,8,["modelValue"]),G]),n("div",J,[h(p(y),{modelValue:s.value,"onUpdate:modelValue":u[3]||(u[3]=e=>s.value=e)},null,8,["modelValue"]),K])]),p(V)?(v(),_("div",O,[(v(),_(w,null,N(5,e=>h(B,{key:e})),64))])):(v(),_("div",Q,[(v(!0),_(w,null,N(p(x),e=>(v(),R(D,{key:e.id,event:e},null,8,["event"]))),128))]))]))}}),te=q(W,[["__file","/Users/nicolasc/Documents/projects/others/nosworld/src/components/structures/NsUserFeed/NsUserFeed.vue"]]);export{te as N};
