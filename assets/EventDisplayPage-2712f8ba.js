import{f as r,h as _,d as N,r as f,q as y,G as k,o as n,H as o,c as l,e as E,J as b,F as D,g as q,M as C,_ as g,u as x,X as F,l as P}from"./index-11704ec7.js";import{u as p,a as v,N as w}from"./NsEvent-74c473b1.js";import"./index.esm-1cfec91b.js";import"./use-settings-34f181de.js";const{fetchEvent:B,fetchEventComments:L}=_();function j(e,{enabled:t}={enabled:!0}){return p({queryKey:["ns-thread",e],queryFn(){return B(r(e))},enabled:t})}function O(e){return p({queryKey:["event-comments",e],async queryFn(){return await L(r(e))},retry:!1})}const Q={key:2},K=N({__name:"NsThread",props:{event:{type:Object},relays:{type:Array,default:()=>[]},id:{type:String},root:{type:Object},inline:Boolean,inThread:Boolean},setup(e){const t=e;f([]),f([]);const c=y(()=>{var d;return((d=t.event)==null?void 0:d.id)??t.id}),{isLoading:u,data:i}=j(c,{enabled:!t.event}),s=y(()=>t.event??i.value),{isLoading:a,data:h}=O(c);return(d,$)=>{const T=k("NsThread",!0);return r(u)?(n(),o(v,{key:0,"in-thread":e.inThread},null,8,["in-thread"])):s.value?(n(),l("div",{key:1,class:C(["ns-thread-component",{"white-box":!e.inThread}])},[E(w,{event:s.value,"in-thread":!!e.root},null,8,["event","in-thread"]),r(a)?(n(),o(v,{key:0,"in-thread":e.inThread},null,8,["in-thread"])):b("v-if",!0),(n(!0),l(D,null,q(r(h),m=>(n(),o(T,{class:"ml-2 border-left-2 border-primary-100",key:m.id,event:m,root:e.root??s.value,"in-thread":""},null,8,["event","root"]))),128))],2)):(n(),l("div",Q,"NOT FOUND"))}}});const S=g(K,[["__scopeId","data-v-5be3ffdd"],["__file","/Users/nicolasc/Documents/projects/others/nosworld/src/components/structures/NsThread/NsThread.vue"]]),{fetchEvent:U}=_();function I(e){return p({queryKey:["event-display-page",e],queryFn(){return U(r(e))}})}const V=N({__name:"EventDisplayPage",props:{id:{type:String,required:!0}},setup(e){const t=e,c=x(),u=y(()=>t.id),{isLoading:i,data:s}=I(u);return F(async()=>{var a;((a=s.value)==null?void 0:a.schema["@type"])==="Person"&&c.push({name:P.profile.display,params:{pubkey:s.value.pubkey,feedType:"activity"},replace:!0})}),(a,h)=>r(i)?(n(),o(v,{key:0})):(n(),o(S,{key:1,id:e.id,event:r(s)},null,8,["id","event"]))}}),J=g(V,[["__file","/Users/nicolasc/Documents/projects/others/nosworld/src/pages/EventDisplayPage/EventDisplayPage.vue"]]);export{J as default};
